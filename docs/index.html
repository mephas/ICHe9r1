<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Treatment effect estimation for time-to-event data under ICH E9 (R1) • ICHe9r1</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Treatment effect estimation for time-to-event data under ICH E9 (R1)">
<meta property="og:description" content="Estimation and inference for the cumulative incidence function for time-to-event outcomes with intercurrent events under ICH E9 (R1).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ICHe9r1</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mephas/ICHe9r1/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="iche9r1">ICHe9r1<a class="anchor" aria-label="anchor" href="#iche9r1"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of ICHe9r1 is to estimate the treatment effect for time-to-event outcomes with intercurrent events under ICH E9 (R1).</p>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>The ICH E9 (R1) proposed five strategies to deal with intercurrent events: treatment policy strategy, composite variable strategy, hypothetical strategy, while on treatment strategy, and principal stratum strategy. To answer a specific scientific question, a specific strategy should be chosen before experimental design and analysis.</p>
<ul>
<li>Treatment policy strategy. The treatment policy strategy addresses the problem of intercurrent events by expanding the initial treatment conditions to a treatment policy. This strategy is applicable only if intercurrent events do not hinder primary outcome events. It is confined to a semicompeting risks context. &lt;&gt;</li>
<li>Composite variable strategy. The composite variable strategy addresses the problem of intercurrent events by expanding the outcome variables. It aggregates the intercurrent event and primary outcome event into a single composite outcome variable. &lt;&gt;</li>
<li>Hypothetical strategy. The hypothetical strategy envisions a hypothetical clinical trial condition where the occurrence of intercurrent events is restricted in certain ways. By doing so, the distribution of potential outcomes under the hypothetical scenario can capture the impact of intercurrent events explicitly through a pre-specified criterion. The hypothetical strategy is closely related to mediation analysis, which is intended to evaluate the direct and indirect effects for semi-competing risks data. &lt;&gt;</li>
<li>While on treatment strategy. The while on treatment strategy considers the measure of outcome variables taken only up to the occurrence of intercurrent events. The failures of primary outcome events should not be counted in the cumulative incidences if intercurrent events occurred. The while on treatment strategy is closely related to the competing risks model. &lt;&gt;</li>
<li>Principal stratum strategy. The principal stratum strategy aims to stratify the population into subpopulations based on the joint potential occurrences of intercurrent events under the two treatment assignments. Usually, we are interested in a principal stratum comprised of individuals who would never experience intercurrent events, regardless of which treatment they receive.</li>
</ul>
<p>Reference: Deng, Y., Han, S., &amp; Zhou, X. H. (2025). Inference for Cumulative Incidences and Treatment Effects in Randomized Controlled Trials With Time‐to‐Event Outcomes Under ICH E9 (R1). Statistics in Medicine, 44(10-12), e70091.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ICHe9r1 from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"mephas/ICHe9r1"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We use the bmt data to illustrate how to estimate the treatment effect. The primary event is death, and the intercurrent event is relapse.</p>
<div class="section level3">
<h3 id="competing-risks-data-structure">Competing risks data structure<a class="anchor" aria-label="anchor" href="#competing-risks-data-structure"></a>
</h3>
<p>The time to the first event (either death or relapse) is t2. The event indicator is d4=d2+d3, so that d4=1 if death occurs first, while d4=2 if relapse occurs first.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mephas/ICHe9r1" class="external-link">ICHe9r1</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; 要求されたパッケージ cmprsk をロード中です</span></span>
<span><span class="co">#&gt; 要求されたパッケージ survival をロード中です</span></span>
<span><span class="co">#&gt; 要求されたパッケージ MASS をロード中です</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bmt</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bmt</span><span class="op">$</span><span class="va">group</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">bmt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'z1'</span>,<span class="st">'z3'</span>,<span class="st">'z5'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">bmt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">bmt</span>, d4<span class="op">=</span><span class="va">d2</span><span class="op">+</span><span class="va">d3</span><span class="op">)</span></span></code></pre></div>
<p>Suppose we would like to use the hypothetical strategy (natural effects). We fit the model by nonparametric estimation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit1 = surv.ICH(A, bmt$t2, bmt$d4, "natural")</span></span>
<span><span class="co"># plot_inc(fit1, legend=c('AML','ALL'))</span></span>
<span><span class="co"># p = fit1$p.val</span></span>
<span><span class="co"># text(200, 0.8, paste0('P = ', round(p,3)))</span></span>
<span><span class="co"># plot_ate(fit1, legend=c('AML','ALL'))</span></span>
<span><span class="co"># ## bootstrap confidence interval</span></span>
<span><span class="co"># plot_ate(fit1, nboot=200, legend=c('AML','ALL'))</span></span></code></pre></div>
<p>We can also use inverse probability weighting to account for confounding.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ps = predict(glm(A ~ X, family='binomial'), type='response')</span></span>
<span><span class="co"># w = A/ps + (1-A)/(1-ps)</span></span>
<span><span class="co"># fit2 = surv.ICH(A, bmt$t2, bmt$d4, "natural", weights=w)</span></span>
<span><span class="co"># plot_inc(fit2, legend=c('AML','ALL'))</span></span>
<span><span class="co"># p = fit1$p.val</span></span>
<span><span class="co"># text(200, 0.8, paste0('P = ', round(p,3)))</span></span>
<span><span class="co"># plot_ate(fit2, legend=c('AML','ALL'))</span></span></code></pre></div>
<p>To increase efficiency, we use the efficient influence function (EIF)-based method.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit3 = surv.ICH(A, bmt$t2, bmt$d4, "natural", X, method='eff')</span></span>
<span><span class="co"># plot_inc(fit3, legend=c('AML','ALL'))</span></span>
<span><span class="co"># p = fit1$p.val</span></span>
<span><span class="co"># text(200, 0.8, paste0('P = ', round(p,3)))</span></span>
<span><span class="co"># plot_ate(fit3, legend=c('AML','ALL'))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="semicompeting-risks-data-structure">Semicompeting risks data structure<a class="anchor" aria-label="anchor" href="#semicompeting-risks-data-structure"></a>
</h3>
<p>Note that the time to death (or censoring) is t1 and the time to relapse (or censoring) is t2. We use the hypothetical strategy (natural effects) and fit the model nonparametrically.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit4 = scr.ICH(A, bmt$t1, bmt$d1, bmt$t2, bmt$d2, "natural")</span></span>
<span><span class="co"># plot_inc(fit4, legend=c('AML','ALL'))</span></span>
<span><span class="co"># p = fit1$p.val</span></span>
<span><span class="co"># text(200, 0.8, paste0('P = ', round(p,3)))</span></span>
<span><span class="co"># plot_ate(fit4, legend=c('AML','ALL'))</span></span>
<span><span class="co"># ## bootstrap confidence interval</span></span>
<span><span class="co"># plot_ate(fit4, nboot=200, legend=c('AML','ALL'))</span></span></code></pre></div>
<p>We can also use inverse probability weighting to account for confounding.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ps = predict(glm(A ~ X, family='binomial'), type='response')</span></span>
<span><span class="co"># w = A/ps + (1-A)/(1-ps)</span></span>
<span><span class="co"># fit5 = scr.ICH(A, bmt$t1, bmt$d1, bmt$t2, bmt$d2, "natural", weights=w)</span></span>
<span><span class="co"># plot_inc(fit5, legend=c('AML','ALL'))</span></span>
<span><span class="co"># p = fit1$p.val</span></span>
<span><span class="co"># text(200, 0.8, paste0('P = ', round(p,3)))</span></span>
<span><span class="co"># plot_ate(fit5, legend=c('AML','ALL'))</span></span></code></pre></div>
<p>To increase efficiency, we use the efficient influence function (EIF)-based method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit6 = surv.ICH(A, bmt$t1, bmt$d1, bmt$t2, bmt$d2, "natural", X, method='eff')</span></span>
<span><span class="co"># plot_inc(fit6, legend=c('AML','ALL'))</span></span>
<span><span class="co"># p = fit1$p.val</span></span>
<span><span class="co"># text(200, 0.8, paste0('P = ', round(p,3)))</span></span>
<span><span class="co"># plot_ate(fit6, legend=c('AML','ALL'))</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mephas/ICHe9r1/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ICHe9r1</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yuhao Deng <br><small class="roles"> Author </small>   </li>
<li>Yi Zhou <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Yuhao Deng, Yi Zhou.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
